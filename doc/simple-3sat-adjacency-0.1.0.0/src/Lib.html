<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lib</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Biapplicative</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bifunctor</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- | A conjunction is simply modeled as a list</span><span>
</span><a name="line-17"></a><span class="hs-keyword">newtype</span><span> </span><a name="Conj"><a href="Lib.html#Conj"><span class="hs-identifier">Conj</span></a></a><span> </span><a name="local-6989586621679025900"><a href="#local-6989586621679025900"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Conj"><a href="Lib.html#Conj"><span class="hs-identifier">Conj</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="runConj"><a href="Lib.html#runConj"><span class="hs-identifier">runConj</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679025900"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-identifier">evalConj</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Conj"><span class="hs-identifier hs-type">Conj</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-20"></a><a name="evalConj"><a href="Lib.html#evalConj"><span class="hs-identifier">evalConj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runConj</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- | Contains @[1..3]@ values</span><span>
</span><a name="line-23"></a><span class="hs-keyword">data</span><span> </span><a name="Upto3"><a href="Lib.html#Upto3"><span class="hs-identifier">Upto3</span></a></a><span> </span><a name="local-6989586621679025899"><a href="#local-6989586621679025899"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Upto1"><a href="Lib.html#Upto1"><span class="hs-identifier">Upto1</span></a></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Upto2"><a href="Lib.html#Upto2"><span class="hs-identifier">Upto2</span></a></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Upto3"><a href="Lib.html#Upto3"><span class="hs-identifier">Upto3</span></a></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679025899"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="Lib.html#Upto3"><span class="hs-identifier hs-type">Upto3</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>  </span><a name="local-8214565720323788724"><span class="hs-identifier">foldr</span></a><span> </span><a name="local-6989586621679025901"><a href="#local-6989586621679025901"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025902"><a href="#local-6989586621679025902"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-special">(</span><a href="Lib.html#Upto1"><span class="hs-identifier hs-var">Upto1</span></a><span> </span><a name="local-6989586621679025903"><a href="#local-6989586621679025903"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025901"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025903"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679025902"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-identifier">foldr</span><span> </span><a name="local-6989586621679025904"><a href="#local-6989586621679025904"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025905"><a href="#local-6989586621679025905"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-special">(</span><a href="Lib.html#Upto2"><span class="hs-identifier hs-var">Upto2</span></a><span> </span><a name="local-6989586621679025906"><a href="#local-6989586621679025906"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679025907"><a href="#local-6989586621679025907"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025904"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025906"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025904"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025907"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679025905"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-identifier">foldr</span><span> </span><a name="local-6989586621679025908"><a href="#local-6989586621679025908"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025909"><a href="#local-6989586621679025909"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="Lib.html#Upto3"><span class="hs-identifier hs-var">Upto3</span></a><span> </span><a name="local-6989586621679025910"><a href="#local-6989586621679025910"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679025911"><a href="#local-6989586621679025911"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025912"><a href="#local-6989586621679025912"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025908"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025910"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025908"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025911"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025908"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025912"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679025909"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | Disjunction of up to three values</span><span>
</span><a name="line-32"></a><span class="hs-keyword">type</span><span> </span><a name="Disj3"><a href="Lib.html#Disj3"><span class="hs-identifier">Disj3</span></a></a><span> </span><a name="local-6989586621679025898"><a href="#local-6989586621679025898"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Upto3"><span class="hs-identifier hs-type">Upto3</span></a><span> </span><a href="#local-6989586621679025898"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-identifier">evalDisj3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Disj3"><span class="hs-identifier hs-type">Disj3</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-35"></a><a name="evalDisj3"><a href="Lib.html#evalDisj3"><span class="hs-identifier">evalDisj3</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Upto1"><span class="hs-identifier hs-var">Upto1</span></a><span> </span><a name="local-6989586621679029802"><a href="#local-6989586621679029802"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029802"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-36"></a><span class="hs-identifier">evalDisj3</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Upto2"><span class="hs-identifier hs-var">Upto2</span></a><span> </span><a name="local-6989586621679029803"><a href="#local-6989586621679029803"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679029804"><a href="#local-6989586621679029804"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029803"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679029804"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-37"></a><span class="hs-identifier">evalDisj3</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Upto3"><span class="hs-identifier hs-var">Upto3</span></a><span> </span><a name="local-6989586621679029805"><a href="#local-6989586621679029805"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679029806"><a href="#local-6989586621679029806"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679029807"><a href="#local-6989586621679029807"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029805"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679029806"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679029807"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | Variables</span><span>
</span><a name="line-40"></a><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-42"></a><span class="hs-comment">--  False -&gt; a</span><span>
</span><a name="line-43"></a><span class="hs-comment">--  True -&gt; not a</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-keyword">newtype</span><span> </span><a name="Var"><a href="Lib.html#Var"><span class="hs-identifier">Var</span></a></a><span> </span><a name="local-6989586621679024060"><a href="#local-6989586621679024060"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Var"><a href="Lib.html#Var"><span class="hs-identifier">Var</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="runVar"><a href="Lib.html#runVar"><span class="hs-identifier">runVar</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679024060"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">evalVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-49"></a><a name="evalVar"><a href="Lib.html#evalVar"><span class="hs-identifier">evalVar</span></a></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679029808"><a href="#local-6989586621679029808"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679029809"><a href="#local-6989586621679029809"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029808"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029809"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | 3-Sat expressions</span><span>
</span><a name="line-52"></a><span class="hs-keyword">type</span><span> </span><a name="Sat3"><a href="Lib.html#Sat3"><span class="hs-identifier">Sat3</span></a></a><span> </span><a name="local-6989586621679024059"><a href="#local-6989586621679024059"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#Conj"><span class="hs-identifier hs-type">Conj</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Disj3"><span class="hs-identifier hs-type">Disj3</span></a><span> </span><span class="hs-special">(</span><a href="Lib.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><a href="#local-6989586621679024059"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">evalSat3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-55"></a><a name="evalSat3"><a href="Lib.html#evalSat3"><span class="hs-identifier">evalSat3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#evalConj"><span class="hs-identifier hs-var">evalConj</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Lib.html#evalDisj3"><span class="hs-identifier hs-var">evalDisj3</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Lib.html#evalVar"><span class="hs-identifier hs-var">evalVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">data</span><span> </span><a name="Universe"><a href="Lib.html#Universe"><span class="hs-identifier">Universe</span></a></a><span> </span><a name="local-6989586621679024058"><a href="#local-6989586621679024058"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Universe"><a href="Lib.html#Universe"><span class="hs-identifier">Universe</span></a></a><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="vars"><a href="Lib.html#vars"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679024058"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="completeVars"><a href="Lib.html#completeVars"><span class="hs-identifier">completeVars</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679024058"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="expr"><a href="Lib.html#expr"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679024058"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-61"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="superExprs"><a href="Lib.html#superExprs"><span class="hs-identifier">superExprs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679024058"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">evalUniverse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-65"></a><a name="evalUniverse"><a href="Lib.html#evalUniverse"><span class="hs-identifier">evalUniverse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#evalSat3"><span class="hs-identifier hs-var">evalSat3</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">expr</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Pick a var if one exists</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- pickVar :: Universe a -&gt; Maybe (a, Universe a)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Pick a complete var if one exists, removing it from the `Set`</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- of `completeVars`</span><span>
</span><a name="line-72"></a><span class="hs-identifier">pickCompleteVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679029801"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029801"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679029801"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><a name="pickCompleteVar"><a href="Lib.html#pickCompleteVar"><span class="hs-identifier">pickCompleteVar</span></a></a><span> </span><a name="local-6989586621679029810"><a href="#local-6989586621679029810"><span class="hs-identifier">u</span></a></a><span class="hs-glyph">@</span><a href="Lib.html#Universe"><span class="hs-identifier hs-var">Universe</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679029815"><a href="#local-6989586621679029815"><span class="hs-identifier">completeVars'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679029810"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">completeVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679029815"><span class="hs-identifier hs-var">completeVars'</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-identifier hs-var">S.minView</span><span> </span><a href="#local-6989586621679029812"><span class="hs-identifier hs-var">completeVars</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Partition into variables adjacent and non-adjacent to the given one</span><span>
</span><a name="line-78"></a><span class="hs-identifier">adjacentTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679029800"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679029800"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679029800"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679029800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679029800"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><a name="adjacentTo"><a href="Lib.html#adjacentTo"><span class="hs-identifier">adjacentTo</span></a></a><span> </span><a name="local-6989586621679029830"><a href="#local-6989586621679029830"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">biliftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Lib.html#adjacentToDisj3"><span class="hs-identifier hs-var">adjacentToDisj3</span></a><span> </span><a href="#local-6989586621679029830"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runVar</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | `adjacentTo` for `Disj3`</span><span>
</span><a name="line-82"></a><span class="hs-identifier">adjacentToDisj3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679029799"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679029799"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Disj3"><span class="hs-identifier hs-type">Disj3</span></a><span> </span><a href="#local-6989586621679029799"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679029799"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679029799"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><a name="adjacentToDisj3"><a href="Lib.html#adjacentToDisj3"><span class="hs-identifier">adjacentToDisj3</span></a></a><span> </span><a name="local-6989586621679029846"><a href="#local-6989586621679029846"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.partition</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679029846"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">S.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toList</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | Partition `Sat3` into adjacent and non-adjacent subexpressions</span><span>
</span><a name="line-86"></a><span class="hs-identifier">filterAdj</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679029798"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679029798"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679029798"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679029798"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679029798"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><a name="filterAdj"><a href="Lib.html#filterAdj"><span class="hs-identifier">filterAdj</span></a></a><span> </span><a name="local-6989586621679029847"><a href="#local-6989586621679029847"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bimap</span><span> </span><a href="Lib.html#Conj"><span class="hs-identifier hs-var">Conj</span></a><span> </span><a href="Lib.html#Conj"><span class="hs-identifier hs-var">Conj</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">L.partition</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679029847"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runVar</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toList</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">runConj</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- | `undefined`</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- Choose a variable to split the `Universe` on</span><span>
</span><a name="line-92"></a><span class="hs-identifier">filterByVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679029797"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679029797"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679029797"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679029797"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-93"></a><a name="filterByVar"><a href="Lib.html#filterByVar"><span class="hs-identifier">filterByVar</span></a></a><span> </span><a name="local-6989586621679029998"><a href="#local-6989586621679029998"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621679029999"><a href="#local-6989586621679029999"><span class="hs-identifier">universe</span></a></a><span class="hs-glyph">@</span><a href="Lib.html#Universe"><span class="hs-identifier hs-var">Universe</span></a><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-94"></a><span>  </span><a href="Lib.html#Universe"><span class="hs-identifier hs-var">Universe</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030004"><span class="hs-identifier hs-var">vars'</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">completeVars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030001"><span class="hs-identifier hs-var">completeVars</span></a><span> </span><span class="hs-operator hs-var">S.\\</span><span> </span><a href="#local-6989586621679030005"><span class="hs-identifier hs-var">anyNotAdj</span></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030006"><span class="hs-identifier hs-var">expr'</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">superExprs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030007"><span class="hs-identifier hs-var">superExpr</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030003"><span class="hs-identifier hs-var">superExprs</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679030004"><a href="#local-6989586621679030004"><span class="hs-identifier">vars'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030005"><a href="#local-6989586621679030005"><span class="hs-identifier">anyNotAdj</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#adjacentTo"><span class="hs-identifier hs-var">adjacentTo</span></a><span> </span><a href="#local-6989586621679029998"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679030008"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lib.html#Sat3"><span class="hs-identifier hs-type">Sat3</span></a><span> </span><a href="#local-6989586621679030008"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030000"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679030006"><a href="#local-6989586621679030006"><span class="hs-identifier">expr'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030007"><a href="#local-6989586621679030007"><span class="hs-identifier">superExpr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lib.html#filterAdj"><span class="hs-identifier hs-var">filterAdj</span></a><span> </span><a href="#local-6989586621679029998"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679030002"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | A pass on adjacent variables in a 3-SAT expression:</span><span>
</span><a name="line-105"></a><span class="hs-comment">--</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-107"></a><span class="hs-comment">--  Any vars that are not adjacent to @var@ are removed from @vars@</span><span>
</span><a name="line-108"></a><span class="hs-comment">--</span><span>
</span><a name="line-109"></a><span class="hs-comment">--  If @var@ is adjacent to any @var'@ that has an instance that is not adjacent to any instance of @var@,</span><span>
</span><a name="line-110"></a><span class="hs-comment">--    then @var'@ is removed from @completeVars@</span><span>
</span><a name="line-111"></a><span class="hs-comment">--</span><span>
</span><a name="line-112"></a><span class="hs-comment">--  The new expression has all subexpressions that contain @var@</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span class="hs-comment">--  The new @superExprs'@ head is all subexpressions that do not contain @var@</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-116"></a><span class="hs-comment">--</span><span>
</span><a name="line-117"></a><span class="hs-identifier">adjacentVarsPass</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><a name="adjacentVarsPass"><a href="Lib.html#adjacentVarsPass"><span class="hs-identifier">adjacentVarsPass</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | `undefined`</span><span>
</span><a name="line-121"></a><span class="hs-comment">--</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-123"></a><span class="hs-comment">--  f universe = case pickCompleteVar universe of</span><span>
</span><a name="line-124"></a><span class="hs-comment">--    Nothing -&gt; case mergeUp universe of</span><span>
</span><a name="line-125"></a><span class="hs-comment">--      Nothing -&gt; universe</span><span>
</span><a name="line-126"></a><span class="hs-comment">--      Just universe' -&gt; f universe'</span><span>
</span><a name="line-127"></a><span class="hs-comment">--    Just (var, universe') -&gt; f (filterByVar var universe')</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-129"></a><span class="hs-comment">--</span><span>
</span><a name="line-130"></a><span class="hs-identifier">mergeUp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679025913"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679025913"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Lib.html#Universe"><span class="hs-identifier hs-type">Universe</span></a><span> </span><a href="#local-6989586621679025913"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><a name="mergeUp"><a href="Lib.html#mergeUp"><span class="hs-identifier">mergeUp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a></pre></body></html>